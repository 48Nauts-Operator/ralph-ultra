{
  "project": "ralph-ultra-v2.2-stability-polish",
  "description": "Ralph Ultra v2.2 - Stability & Polish: Pre-flight checks, UI improvements, and execution reliability features",
  "branchName": "ralph/v2.2-stability-polish",
  "userStories": [
    {
      "id": "US-001",
      "title": "Claude API status pre-flight check",
      "description": "Before starting Ralph execution, check the Anthropic status page for any ongoing incidents. Display clear status message and allow user to proceed anyway with confirmation. Cache status for 5 minutes to avoid excessive checks. This prevents wasted time and tokens during outages.",
      "acceptanceCriteria": [
        {
          "id": "AC-001-1",
          "text": "Status check function exists that fetches Anthropic status",
          "testCommand": "grep -q 'anthropic\\|checkApiStatus\\|ApiStatus' src/utils/status-check.ts || grep -q 'statusCheck' src/utils/ralph-service.ts",
          "passes": true,
          "lastRun": "2026-01-23T01:39:08.263Z"
        },
        {
          "id": "AC-001-2",
          "text": "Status is displayed in StatusBar or before run starts",
          "testCommand": "grep -q 'apiStatus\\|statusCheck\\|operational' src/components/StatusBar.tsx || grep -q 'apiStatus' src/components/App.tsx",
          "passes": true,
          "lastRun": "2026-01-23T01:39:08.263Z"
        },
        {
          "id": "AC-001-3",
          "text": "User can bypass status warning and proceed anyway",
          "testCommand": "grep -q 'force\\|proceed\\|bypass\\|ignoreStatus' src/utils/ralph-service.ts || grep -q 'ignoreStatus' src/components/App.tsx",
          "passes": true,
          "lastRun": "2026-01-23T01:39:08.263Z"
        }
      ],
      "complexity": "medium",
      "priority": 1,
      "passes": true
    },
    {
      "id": "US-002",
      "title": "Recent projects list",
      "description": "Show a list of recently opened projects for quick access. Store last 10 projects with timestamps. Display in ProjectsRail or as a dropdown. Allow clearing history. This reduces friction when switching between projects.",
      "acceptanceCriteria": [
        {
          "id": "AC-002-1",
          "text": "Recent projects are stored persistently",
          "testCommand": "grep -q 'recentProjects\\|projectHistory' src/utils/config.ts || grep -q 'recentProjects' src/utils/session.ts",
          "passes": true,
          "lastRun": "2026-01-23T03:00:58.401Z"
        },
        {
          "id": "AC-002-2",
          "text": "Recent projects displayed in UI",
          "testCommand": "grep -q 'recentProjects\\|Recent' src/components/ProjectsRail.tsx || grep -q 'recentProjects' src/components/App.tsx",
          "passes": true,
          "lastRun": "2026-01-23T03:00:58.401Z"
        },
        {
          "id": "AC-002-3",
          "text": "User can select from recent projects to switch",
          "testCommand": "grep -q 'selectRecent\\|onRecentSelect\\|handleRecentProject' src/components/ProjectsRail.tsx || grep -q 'recentProject' src/components/App.tsx",
          "passes": false,
          "lastRun": "2026-01-23T03:00:58.401Z"
        }
      ],
      "complexity": "simple",
      "priority": 2,
      "passes": false
    },
    {
      "id": "US-003",
      "title": "Progress file integration",
      "description": "Maintain a progress.txt file in the project directory that persists execution state between runs. Track which stories have been attempted, pass/fail history, and timestamps. This enables resuming work after crashes or restarts.",
      "acceptanceCriteria": [
        {
          "id": "AC-003-1",
          "text": "Progress file is written during execution",
          "testCommand": "grep -q 'progress.txt\\|writeProgress\\|progressFile' src/utils/ralph-service.ts",
          "passes": false,
          "lastRun": null
        },
        {
          "id": "AC-003-2",
          "text": "Progress includes story attempts and results",
          "testCommand": "grep -q 'attempts\\|storyProgress\\|executionHistory' src/utils/ralph-service.ts",
          "passes": false,
          "lastRun": null
        },
        {
          "id": "AC-003-3",
          "text": "Progress is read on startup to show history",
          "testCommand": "grep -q 'readProgress\\|loadProgress\\|parseProgress' src/utils/ralph-service.ts",
          "passes": false,
          "lastRun": null
        }
      ],
      "complexity": "simple",
      "priority": 3,
      "passes": false
    },
    {
      "id": "US-004",
      "title": "Context window budget display",
      "description": "Display estimated context window usage as a percentage or token count. Show warning when approaching limits. Parse Claude output for token usage if available. This prevents unexpected truncation and helps users understand costs.",
      "acceptanceCriteria": [
        {
          "id": "AC-004-1",
          "text": "Token usage is tracked or estimated",
          "testCommand": "grep -q 'tokenUsage\\|contextBudget\\|tokenCount' src/utils/ralph-service.ts || grep -q 'tokens' src/utils/session-tracker.ts",
          "passes": false,
          "lastRun": null
        },
        {
          "id": "AC-004-2",
          "text": "Token/context budget displayed in StatusBar or WorkPane",
          "testCommand": "grep -q 'tokens\\|contextBudget\\|tokenUsage' src/components/StatusBar.tsx || grep -q 'Tokens' src/components/WorkPane.tsx",
          "passes": false,
          "lastRun": null
        },
        {
          "id": "AC-004-3",
          "text": "Warning shown when approaching context limit",
          "testCommand": "grep -q 'tokenWarning\\|contextLimit\\|approaching' src/components/StatusBar.tsx || grep -q 'tokenLimit' src/hooks/useNotifications.tsx",
          "passes": false,
          "lastRun": null
        }
      ],
      "complexity": "medium",
      "priority": 4,
      "passes": false
    },
    {
      "id": "US-005",
      "title": "Small task enforcement warning",
      "description": "Warn users when a story description or acceptance criteria seem too large or complex. Check for word count, number of ACs, or complexity indicators. Suggest breaking into smaller stories. This prevents scope creep and improves success rates.",
      "acceptanceCriteria": [
        {
          "id": "AC-005-1",
          "text": "Story complexity is analyzed before execution",
          "testCommand": "grep -q 'analyzeComplexity\\|checkStorySize\\|storyTooLarge\\|validateStory' src/utils/ralph-service.ts",
          "passes": false,
          "lastRun": null
        },
        {
          "id": "AC-005-2",
          "text": "Warning displayed for overly complex stories",
          "testCommand": "grep -q 'complexityWarning\\|tooComplex\\|breakDown\\|storyWarning' src/components/WorkPane.tsx || grep -q 'storyWarning' src/components/SessionsPane.tsx",
          "passes": false,
          "lastRun": null
        },
        {
          "id": "AC-005-3",
          "text": "User can acknowledge warning and proceed",
          "testCommand": "grep -q 'acknowledgeWarning\\|proceedAnyway\\|ignoreComplexity\\|complexityOverride' src/components/App.tsx || grep -q 'complexityOverride' src/utils/ralph-service.ts",
          "passes": false,
          "lastRun": null
        }
      ],
      "complexity": "medium",
      "priority": 5,
      "passes": false
    },
    {
      "id": "US-006",
      "title": "Debug mode with verbose logging",
      "description": "Add a debug mode that shows verbose internal state, timing information, and detailed error messages. Toggle with 'd' key or --debug flag. Useful for troubleshooting issues with Ralph or understanding execution flow.",
      "acceptanceCriteria": [
        {
          "id": "AC-006-1",
          "text": "Debug mode flag exists in config or state",
          "testCommand": "grep -q 'debugMode\\|isDebug\\|DEBUG' src/utils/config.ts || grep -q 'debugMode' src/components/App.tsx",
          "passes": false,
          "lastRun": null
        },
        {
          "id": "AC-006-2",
          "text": "Debug mode can be toggled via keyboard or flag",
          "testCommand": "grep -q \"key: 'd'\\|--debug\" src/components/App.tsx || grep -q 'toggleDebug' src/components/App.tsx",
          "passes": false,
          "lastRun": null
        },
        {
          "id": "AC-006-3",
          "text": "Debug mode shows additional information in logs",
          "testCommand": "grep -q 'debugMode\\|isDebug' src/utils/ralph-service.ts || grep -q 'debug.*log\\|verbose' src/utils/ralph-service.ts",
          "passes": false,
          "lastRun": null
        }
      ],
      "complexity": "simple",
      "priority": 6,
      "passes": false
    }
  ]
}